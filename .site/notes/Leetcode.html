<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>So me quitの博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/logo.png">
    <meta name="description" content="Java 不止与不止 Java！">
    
    <link rel="preload" href="/assets/css/0.styles.062cab53.css" as="style"><link rel="preload" href="/assets/js/app.71d4a6a5.js" as="script"><link rel="preload" href="/assets/js/2.f1d316d3.js" as="script"><link rel="preload" href="/assets/js/1.a430dc98.js" as="script"><link rel="preload" href="/assets/js/23.ccdce7e7.js" as="script"><link rel="prefetch" href="/assets/js/10.8e96790e.js"><link rel="prefetch" href="/assets/js/11.71bcab59.js"><link rel="prefetch" href="/assets/js/12.aa9e51c3.js"><link rel="prefetch" href="/assets/js/13.e697ee22.js"><link rel="prefetch" href="/assets/js/14.6f2e6630.js"><link rel="prefetch" href="/assets/js/15.62507793.js"><link rel="prefetch" href="/assets/js/16.7b14dc73.js"><link rel="prefetch" href="/assets/js/17.339057ef.js"><link rel="prefetch" href="/assets/js/18.77e1e683.js"><link rel="prefetch" href="/assets/js/19.716d85cc.js"><link rel="prefetch" href="/assets/js/20.0a32ca20.js"><link rel="prefetch" href="/assets/js/21.e23086f0.js"><link rel="prefetch" href="/assets/js/22.03f0f232.js"><link rel="prefetch" href="/assets/js/24.69e4992c.js"><link rel="prefetch" href="/assets/js/3.4f2dc405.js"><link rel="prefetch" href="/assets/js/4.d4b46179.js"><link rel="prefetch" href="/assets/js/5.bb5d94da.js"><link rel="prefetch" href="/assets/js/6.bff5437f.js"><link rel="prefetch" href="/assets/js/7.e6ffba0d.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.5e19b665.js">
    <link rel="stylesheet" href="/assets/css/0.styles.062cab53.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="So me quitの博客" class="logo"> <span class="site-name can-hide">So me quitの博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  作者
</a></div><div class="nav-item"><a href="https://kotkot.club/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  更多相关
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="选择笔记" class="dropdown-title"><span class="title">选择笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="选择笔记" class="mobile-dropdown-title"><span class="title">选择笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          歌声合成
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/music/transcripting/" class="nav-link">
  扒谱
</a></li><li class="dropdown-subitem"><a href="/music/UTAU/" class="nav-link">
  UTAU
</a></li><li class="dropdown-subitem"><a href="/music/mixing/" class="nav-link">
  混音
</a></li></ul></li><li class="dropdown-item"><h4>
          网页开发
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/web/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-subitem"><a href="/web/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-subitem"><a href="/web/js/" class="nav-link">
  JavaScript
</a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  作者
</a></div><div class="nav-item"><a href="https://kotkot.club/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  更多相关
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="选择笔记" class="dropdown-title"><span class="title">选择笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="选择笔记" class="mobile-dropdown-title"><span class="title">选择笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          歌声合成
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/music/transcripting/" class="nav-link">
  扒谱
</a></li><li class="dropdown-subitem"><a href="/music/UTAU/" class="nav-link">
  UTAU
</a></li><li class="dropdown-subitem"><a href="/music/mixing/" class="nav-link">
  混音
</a></li></ul></li><li class="dropdown-item"><h4>
          网页开发
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/web/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-subitem"><a href="/web/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-subitem"><a href="/web/js/" class="nav-link">
  JavaScript
</a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/Leetcode.html#java-数学-01背包变种" class="sidebar-link">Java + 数学 + 01背包变种</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/notes/Leetcode.html#第一步" class="sidebar-link">第一步：</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/notes/Leetcode.html#第二步" class="sidebar-link">第二步：</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/notes/Leetcode.html#第三步" class="sidebar-link">第三步：</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>@[toc]</p> <h1 id="题目"><a href="#题目" class="header-anchor">#</a> 题目</h1> <ul><li>Problem: <a href="https://leetcode.cn/problems/find-the-sum-of-the-power-of-all-subsequences/description/" target="_blank" rel="noopener noreferrer">100241. 求出所有子序列的能量和<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>给你一个长度为 n 的整数数组 nums 和一个 正 整数 k 。</li> <li>一个整数数组的 能量 定义为和 等于 k 的子序列的数目。</li> <li>请你返回 nums 中所有子序列的 能量和 。</li> <li>由于答案可能很大，请你将它对 10 ^ 9 + 7 取余 后返回。</li> <li>1 &lt;= n &lt;= 100</li> <li>1 &lt;= nums[i] &lt;= 10 ^ 4</li> <li>1 &lt;= k &lt;= 100</li></ul> <h1 id="思路"><a href="#思路" class="header-anchor">#</a> 思路</h1> <h2 id="java-数学-01背包变种"><a href="#java-数学-01背包变种" class="header-anchor">#</a> Java + 数学 + 01背包变种</h2> <h2 id="第一步"><a href="#第一步" class="header-anchor">#</a> 第一步：</h2> <ul><li>首先题目意思是求子序列的子序列和为 k 的总个数，</li> <li>接着为了保证数据不重不漏，可以按照公式求：</li> <li>选 l 个元素和为 k 的所有可能性个数 * 剩下 n - l 个元素选或不选的所有可能性个数。</li> <li>最后由于元素均为正整数，因此枚举 l 为 [1, k] 即可</li></ul> <h2 id="第二步"><a href="#第二步" class="header-anchor">#</a> 第二步：</h2> <ul><li>选 l 个元素和为 k 的所有可能性个数，</li> <li>假设忽略 l 个元素，即序列和为 k 的个数，直接套用 01 背包，
<ul><li>dp[i][j] 代表前 i 个元素和为 j 的总个数</li> <li>dp[i][j] = dp[i-1][j-nums[l]]，nums[l] &lt;= j &lt;= k</li> <li>空间优化掉 i，倒序遍历 j 即可</li></ul></li> <li>然后添加一维 l 代表选 l 个元素，最后结果就是 dp[l][k]
<ul><li>可看做 dp[i][l][j] 代表前 i 个元素选择 l 个元素和为 j 的总个数</li> <li>dp[i][l][j] = dp[i-1][l-1][j-nums[l]]，nums[l] &lt;= j &lt;= k（代表选择 nums[l] 这个元素）</li> <li>空间优化掉 i，倒序遍历 j 即可</li></ul></li></ul> <h2 id="第三步"><a href="#第三步" class="header-anchor">#</a> 第三步：</h2> <ul><li>剩下 n-l 个元素选或不选的所有可能性个数，</li> <li>假设 l=1 即选择的元素就是 k，</li> <li>此时 n-1 个元素就有 2^(n-1) 种可能性（参考实例 1），</li> <li>最后注意使用带 mod 的快速幂</li></ul> <h1 id="复杂度"><a href="#复杂度" class="header-anchor">#</a> 复杂度</h1> <p>时间复杂度:</p> <blockquote><p>时间复杂度： $O(nk^2)$</p></blockquote> <p>空间复杂度:</p> <blockquote><p>空间复杂度： $O(k^2)$</p></blockquote> <h1 id="code"><a href="#code" class="header-anchor">#</a> Code</h1> <div class="language-Java [] extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * Java + 数学 + 01背包变种
     *
     * 第一步：
     * 首先题目意思是求子序列的子序列和为 k 的总个数，
     * 接着为了保证数据不重不漏，可以按照公式求：
     * 选 l 个元素和为 k 的所有可能性个数 * 剩下 n - l 个元素选或不选的所有可能性个数。
     * 最后由于元素均为正整数，因此枚举 l 为 [1, k] 即可
     *
     * 第二步：
     * 选 l 个元素和为 k 的所有可能性个数，
     * 假设忽略 l 个元素，即序列和为 k 的个数，直接套用 01 背包，
     *     * dp[i][j] 代表前 i 个元素和为 j 的总个数
     *     * dp[i][j] = dp[i-1][j-nums[l]]，nums[l] &lt;= j &lt;= k
     *     * 空间优化掉 i，倒序遍历 j 即可
     * 然后添加一维 l 代表选 l 个元素，最后结果就是 dp[l][k]
     *     * 可看做 dp[i][l][j] 代表前 i 个元素选择 l 个元素和为 j 的总个数
     *     * dp[i][l][j] = dp[i-1][l-1][j-nums[l]]，nums[l] &lt;= j &lt;= k（代表选择 nums[l] 这个元素）
     *     * 空间优化掉 i，倒序遍历 j 即可
     *
     * 第三步：
     * 剩下 n-l 个元素选或不选的所有可能性个数，
     * 假设 l=1 即选择的元素就是 k，
     * 此时 n-1 个元素就有 2^(n-1) 种可能性（参考实例 1），
     * 最后注意使用带 mod 的快速幂
     *
     * 时间复杂度：O（nk^2），空间复杂度：O（k^2）
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">sumOfPower</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> mod <span class="token operator">=</span> <span class="token number">1_000_000_007</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

        <span class="token comment">// 排序让大于 k 的元素直接返回</span>
        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 01 背包变种（空间优化后），dp[l][j] 代表选 l 个元素和为 j 的所有可能性个数</span>
        <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">long</span><span class="token punctuation">[</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// 不选任何元素总和为 0 才需要初始化</span>
        dp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> k<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token comment">// 01 背包空间优化需要倒序</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> k<span class="token punctuation">;</span> j <span class="token operator">&gt;=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> l <span class="token operator">&lt;</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> l<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    dp<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> dp<span class="token punctuation">[</span>l <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    dp<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">%=</span> mod<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>

        <span class="token keyword">long</span> res <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">;</span>
        <span class="token comment">// 选 l 个元素总和为 k</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> l <span class="token operator">&lt;=</span> k<span class="token punctuation">;</span> l<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 选 l 个元素和为 k 的所有可能性个数 * 剩下 n - l 个元素选或不选的所有可能性个数 *</span>
            res <span class="token operator">+=</span> dp<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token function">qPow</span><span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span> n <span class="token operator">-</span> l<span class="token punctuation">,</span> mod<span class="token punctuation">)</span><span class="token punctuation">;</span>
            res <span class="token operator">%=</span> mod<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">%</span> mod<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">long</span> <span class="token function">qPow</span><span class="token punctuation">(</span><span class="token keyword">long</span> value<span class="token punctuation">,</span> <span class="token keyword">long</span> pow<span class="token punctuation">,</span> <span class="token keyword">long</span> mod<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> res <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>pow <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>pow <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                res <span class="token operator">*=</span> value<span class="token punctuation">;</span>
                res <span class="token operator">%=</span> mod<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            value <span class="token operator">*=</span> value<span class="token punctuation">;</span>
            value <span class="token operator">%=</span> mod<span class="token punctuation">;</span>
            pow <span class="token operator">&gt;&gt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> res<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.71d4a6a5.js" defer></script><script src="/assets/js/2.f1d316d3.js" defer></script><script src="/assets/js/1.a430dc98.js" defer></script><script src="/assets/js/23.ccdce7e7.js" defer></script>
  </body>
</html>
